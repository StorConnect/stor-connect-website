---
// Cookie Consent mit lokalem Klaro (npm package)
import 'klaro/dist/klaro.css';
---

<script is:inline>
  // Klaro Config MUSS VOR dem Klaro-Script definiert werden
  window.klaroConfig = {
    version: 1,
    elementID: 'klaro',
    storageMethod: 'cookie',
    cookieName: 'klaro-consent',
    cookieExpiresAfterDays: 365,
    default: false,
    mustConsent: true,
    acceptAll: true,
    hideDeclineAll: false,
    hideLearnMore: false,
    
    lang: 'de',
    
    translations: {
      de: {
        consentModal: {
          title: 'Cookies & Datenschutz',
          description: 'Wir verwenden Cookies, um Ihre Erfahrung auf unserer Website zu verbessern.',
        },
        consentNotice: {
          changeDescription: 'Es gab Änderungen seit Ihrem letzten Besuch.',
          description: 'Wir verwenden Cookies und andere Technologien auf unserer Website. Einige davon sind essenziell, während andere uns helfen, diese Website und Ihre Erfahrung zu verbessern.',
          learnMore: 'Mehr erfahren',
        },
        ok: 'Alle akzeptieren',
        save: 'Auswahl speichern',
        decline: 'Nur notwendige',
        close: 'Schließen',
        acceptAll: 'Alle akzeptieren',
        acceptSelected: 'Auswahl speichern',
        privacyPolicyUrl: '/datenschutz',
        app: {
          disableAll: {
            title: 'Alle Anwendungen umschalten',
            description: 'Verwenden Sie diesen Schalter, um alle Anwendungen zu aktivieren/deaktivieren.'
          },
          optOut: {
            title: '(Opt-Out)',
            description: 'Diese Anwendung wird standardmäßig geladen.'
          },
          required: {
            title: '(immer erforderlich)',
            description: 'Diese Anwendung ist immer erforderlich.'
          },
          purposes: 'Zwecke',
          purpose: 'Zweck'
        },
        poweredBy: ''
      }
    },
    
    services: [
      {
        name: 'necessary',
        title: 'Notwendige Cookies',
        description: 'Diese Cookies sind für die Grundfunktionen der Website erforderlich.',
        purposes: ['essential'],
        required: true,
        default: true,
      },
      {
        name: 'analytics',
        title: 'Analyse-Cookies',
        description: 'Diese Cookies helfen uns zu verstehen, wie Besucher mit unserer Website interagieren.',
        purposes: ['analytics'],
        required: false,
        default: false,
      },
      {
        name: 'functional',
        title: 'Funktionale Cookies',
        description: 'Diese Cookies ermöglichen erweiterte Funktionalität und Personalisierung.',
        purposes: ['functional'],
        required: false,
        default: false,
      }
    ]
  };
</script>

<script>
  // Klaro vom npm package importieren und initialisieren
  import * as Klaro from 'klaro';
  
  // Warte bis DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      Klaro.setup(window.klaroConfig);
    });
  } else {
    Klaro.setup(window.klaroConfig);
  }
</script>

<style is:global>
  /* STOR Connect CI Rot für Cookie-Banner */
  .klaro .cm-btn.cm-btn-success {
    background-color: #E01D22 !important;
  }
  
  .klaro .cm-btn.cm-btn-success:hover {
    background-color: #C9302C !important;
  }
  
  .klaro .cookie-modal,
  .klaro .cookie-notice {
    font-family: inherit;
  }
</style>
